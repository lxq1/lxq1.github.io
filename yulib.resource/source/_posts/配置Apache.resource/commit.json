{"compress":true,"commitItems":[["67a46735-d583-4e31-b360-8be85693f377",1532325863111,"# 虚拟机全新Linux用源码安装Apache\n\n安装方式可以采用源码安装或二进制数据包安装，源码安装是可以定制的一种安装方式，自由度比较高，满足企业对各种环境的不同需求。\n源码安装需要大量的依赖软件包。\n\n二进制数据包选择rpm包安装，简单快捷。\n\n## 1. 下载软件包\n\n采用wget联网下载以下的源码包\n\n*  [apache](https://mirrors.tuna.tsinghua.edu.cn/apache//httpd/httpd-2.4.33.tar.gz)\n* [apr](http://mirrors.hust.edu.cn/apache//apr/apr-1.6.3.tar.gz)\n* [apr-util](https://mirrors.tuna.tsinghua.edu.cn/apache//apr/apr-util-1.6.1.tar.gz)\n\n\n## 2. 安装软件\n\n由于我们采用了源码安装Apache，所以安装Apache Http Server 之前需要安装很多依赖软件包，可以使用yum安装。\n\n```\nyum -y install gcc autoconf automake make \\\n> pcre pcre-devel openssl openssl-devel\n\n还需要补充上error1的解决办法\n```\n\n![Linux-pic1](_v_images/_linuxpic1_1526612290_8129.png)\n\n```\n\n[root@localhost ~]# tar -xzf httpd-2.4.33.tar.gz -C /usr/src/\n[root@localhost ~]# tar -xzf apr-1.6.3.tar.gz -C /usr/src\n[root@localhost ~]# tar -xzf apr-util-1.6.1.tar.gz -C /usr/src/\n\n[root@localhost ~]# cd /usr/src/\n[root@localhost src]# cd apr-1.6.3/\n[root@localhost apr-1.6.3]# ./configure\n\n[root@localhost apr-1.6.3]# make && make install\n\n[root@localhost apr-util-1.6.1]# ./configure --with-apr=/usr/local/apr\n\n[root@localhost apr-util-1.6.1]# make && make install \n\n提示缺少error1\n\n[root@localhost src]# cd httpd-2.4.33/\n\n[root@localhost httpd-2.4.33]# ./configure --prefix=/usr/local/apache2 --enable-so \\\n> --enable-ssl --enable-rewrite --with-mpm=worker --with-suexec-bin \\\n> --with-apr=/usr/local/apr/\n\n[root@localhost httpd-2.4.33]# make && make install\n提示error2\n\n```\n\n## 3. 启动软件\n\n```\n/usr/local/apache2/bin/apachectl start\n\n```\n\n* 配置防火墙\n\niptable -I  INPUT -P tcp --dport 80 -j ACCEPT\n\nserver iptables save \n\n* 查看端口是否启用\n\n## 发生过的错误\n\n### error1 缺少expat-devel包\n```\nxml/apr_xml.c:35:19: 致命错误：expat.h：没有那个文件或目录\n #include <expat.h>\n                   ^\n编译中断。\nmake[1]: *** [xml/apr_xml.lo] 错误 1\nmake[1]: 离开目录“/usr/src/apr-util-1.6.1”\nmake: *** [all-recursive] 错误 1\n```\n* 解决办法\nyum install expat-devel\n\n### error2 [htpasswd] 错误 \n```\n\ncollect2: error: ld returned 1 exit status\nmake[2]: *** [htpasswd] 错误 1\nmake[2]: 离开目录“/usr/src/httpd-2.4.33/support”\nmake[1]: *** [all-recursive] 错误 1\nmake[1]: 离开目录“/usr/src/httpd-2.4.33/support”\nmake: *** [all-recursive] 错误 1\n\n\n\n```\n\n\n* 解决办法\n```\ncd /usr/src/\ncp -r apr-1.6.3  /usr/src/httpd-2.4.33/srclib/apr\ncd apr-1.6.3\n./configure --prefix=/usr/local/apr\nmake && make install\n\ncp -r apr-util-1.6.1  /usr/local/src/httpd-2.4.33/srclib/apr-util\ncd /usr/src/apr-util-1.6.1\n./configure --prefix=/usr/local/apr-util --with-apr=/usr/local/apr\nmake && make install\n\ncd /usr/src/httpd-2.4.33\n./configure --with-included-apr --prefix=/usr/local/apache2 --with-apr=/usr/local/apr --with-apr-util=/usr/local/apr-util --enable-so --enable-ssl --enable-rewrite --with-mpm=worker --with-suexec-bin \nmake && make install\n```\n\n\n# 写一个相对完美点的全部安装代码\n\n```\n\nyum -y install gcc autoconf automake make \\\n> pcre pcre-devel openssl openssl-devel expat-devel\n\n tar -xzf httpd-2.4.33.tar.gz -C /usr/src/\n tar -xzf apr-1.6.3.tar.gz -C /usr/src\n tar -xzf apr-util-1.6.1.tar.gz -C /usr/src/\n\ncd /usr/src/\ncp -r apr-1.6.3  /usr/src/httpd-2.4.33/srclib/apr\ncd apr-1.6.3\n./configure --prefix=/usr/local/apr\nmake && make install\n\ncp -r apr-util-1.6.1  /usr/src/httpd-2.4.33/srclib/apr-util\ncd /usr/src/apr-util-1.6.1\n./configure --prefix=/usr/local/apr-util --with-apr=/usr/local/apr\nmake && make install\n\ncd /usr/src/httpd-2.4.33\n./configure --with-included-apr --prefix=/usr/local/apache2 --with-apr=/usr/local/apr --with-apr-util=/usr/local/apr-util --enable-so --enable-ssl --enable-rewrite --with-mpm=worker --with-suexec-bin \nmake && make install\n```\n\n\n",[[1532325840413,["lixq@lixq-PC",[[-1,586,"Linux-pic1"],[-1,598,"_v_"],[1,601,"https://ws1.sina"],[1,603,"g.cn/l"],[1,604,"r"],[-1,606,"s/_linuxpic1_1526612290_8129.pn"],[1,637,"/640dde2dly1ftjrebt1gvj20s40arjte.jp"]],[584,639],[654,654]]]],null,"lixq@lixq-PC"],["f021ba4f-1bb6-42dd-9a0a-60c5da3a669d",1532327112507,"# 虚拟机全新Linux用源码安装Apache\n\n安装方式可以采用源码安装或二进制数据包安装，源码安装是可以定制的一种安装方式，自由度比较高，满足企业对各种环境的不同需求。\n源码安装需要大量的依赖软件包。\n\n二进制数据包选择rpm包安装，简单快捷。\n\n## 1. 下载软件包\n\n采用wget联网下载以下的源码包\n\n*  [apache](https://mirrors.tuna.tsinghua.edu.cn/apache//httpd/httpd-2.4.33.tar.gz)\n* [apr](http://mirrors.hust.edu.cn/apache//apr/apr-1.6.3.tar.gz)\n* [apr-util](https://mirrors.tuna.tsinghua.edu.cn/apache//apr/apr-util-1.6.1.tar.gz)\n\n\n## 2. 安装软件\n\n由于我们采用了源码安装Apache，所以安装Apache Http Server 之前需要安装很多依赖软件包，可以使用yum安装。\n\n```\nyum -y install gcc autoconf automake make \\\n> pcre pcre-devel openssl openssl-devel\n\n还需要补充上error1的解决办法\n```\n\n![](https://ws1.sinaimg.cn/large/640dde2dly1ftjrebt1gvj20s40arjte.jpg)\n\n```\n\n[root@localhost ~]# tar -xzf httpd-2.4.33.tar.gz -C /usr/src/\n[root@localhost ~]# tar -xzf apr-1.6.3.tar.gz -C /usr/src\n[root@localhost ~]# tar -xzf apr-util-1.6.1.tar.gz -C /usr/src/\n\n[root@localhost ~]# cd /usr/src/\n[root@localhost src]# cd apr-1.6.3/\n[root@localhost apr-1.6.3]# ./configure\n\n[root@localhost apr-1.6.3]# make && make install\n\n[root@localhost apr-util-1.6.1]# ./configure --with-apr=/usr/local/apr\n\n[root@localhost apr-util-1.6.1]# make && make install \n\n提示缺少error1\n\n[root@localhost src]# cd httpd-2.4.33/\n\n[root@localhost httpd-2.4.33]# ./configure --prefix=/usr/local/apache2 --enable-so \\\n> --enable-ssl --enable-rewrite --with-mpm=worker --with-suexec-bin \\\n> --with-apr=/usr/local/apr/\n\n[root@localhost httpd-2.4.33]# make && make install\n提示error2\n\n```\n\n## 3. 启动软件\n\n```\n/usr/local/apache2/bin/apachectl start\n\n```\n\n* 配置防火墙\n\niptable -I  INPUT -P tcp --dport 80 -j ACCEPT\n\nserver iptables save \n\n* 查看端口是否启用\n\n## 发生过的错误\n\n### error1 缺少expat-devel包\n```\nxml/apr_xml.c:35:19: 致命错误：expat.h：没有那个文件或目录\n #include <expat.h>\n                   ^\n编译中断。\nmake[1]: *** [xml/apr_xml.lo] 错误 1\nmake[1]: 离开目录“/usr/src/apr-util-1.6.1”\nmake: *** [all-recursive] 错误 1\n```\n* 解决办法\nyum install expat-devel\n\n### error2 [htpasswd] 错误 \n```\n\ncollect2: error: ld returned 1 exit status\nmake[2]: *** [htpasswd] 错误 1\nmake[2]: 离开目录“/usr/src/httpd-2.4.33/support”\nmake[1]: *** [all-recursive] 错误 1\nmake[1]: 离开目录“/usr/src/httpd-2.4.33/support”\nmake: *** [all-recursive] 错误 1\n\n\n\n```\n\n\n* 解决办法\n```\ncd /usr/src/\ncp -r apr-1.6.3  /usr/src/httpd-2.4.33/srclib/apr\ncd apr-1.6.3\n./configure --prefix=/usr/local/apr\nmake && make install\n\ncp -r apr-util-1.6.1  /usr/local/src/httpd-2.4.33/srclib/apr-util\ncd /usr/src/apr-util-1.6.1\n./configure --prefix=/usr/local/apr-util --with-apr=/usr/local/apr\nmake && make install\n\ncd /usr/src/httpd-2.4.33\n./configure --with-included-apr --prefix=/usr/local/apache2 --with-apr=/usr/local/apr --with-apr-util=/usr/local/apr-util --enable-so --enable-ssl --enable-rewrite --with-mpm=worker --with-suexec-bin \nmake && make install\n```\n\n\n# 写一个相对完美点的全部安装代码\n\n```\n\nyum -y install gcc autoconf automake make \\\n> pcre pcre-devel openssl openssl-devel expat-devel\n\n tar -xzf httpd-2.4.33.tar.gz -C /usr/src/\n tar -xzf apr-1.6.3.tar.gz -C /usr/src\n tar -xzf apr-util-1.6.1.tar.gz -C /usr/src/\n\ncd /usr/src/\ncp -r apr-1.6.3  /usr/src/httpd-2.4.33/srclib/apr\ncd apr-1.6.3\n./configure --prefix=/usr/local/apr\nmake && make install\n\ncp -r apr-util-1.6.1  /usr/src/httpd-2.4.33/srclib/apr-util\ncd /usr/src/apr-util-1.6.1\n./configure --prefix=/usr/local/apr-util --with-apr=/usr/local/apr\nmake && make install\n\ncd /usr/src/httpd-2.4.33\n./configure --with-included-apr --prefix=/usr/local/apache2 --with-apr=/usr/local/apr --with-apr-util=/usr/local/apr-util --enable-so --enable-ssl --enable-rewrite --with-mpm=worker --with-suexec-bin \nmake && make install\n```\n\n\n",[[1532327054814,["lixq@lixq-PC",[[1,0,"\n"]],[0,0],[1,1]]],[1532327055824,["lixq@lixq-PC",[[1,0,"---\ntitle:\ncategories:\ntags:\n---"]],[0,0],[32,32]]]],null,"lixq@lixq-PC"]]}