{"compress":true,"commitItems":[["4ad58d97-52c2-43f4-90bb-e6449ff48f45",1532327138257,"# MySQL\n\n\n## 显示所有的数据库\n\n\n\n```\n\nshow databases;\n\n\n```\n\n1251错误\n\n我的是8.0的版本，因为比较新的mysql采用新的保密方式所以旧的似乎不能用，改密码方式：\n\n```\n\nuse mysql；\nALTER USER 'root'@'%' IDENTIFIED WITH mysql_native_password BY 'qianqiannihao';\n\nFLUSH PRIVILEGES; \n```\n\n\n\n\n这两天用docker搭了个mariadb碰到一些问题在此记录一下。\n\n搭建步骤\n```\n\n1 docker pull 最新的 mariadb镜像\n\n2. 用镜像建立mariadb的 container\n\ndocker run --name mdb1 -v /home/xx/docker_mdb1_data:/var/lib/mysql \\\n\n-p 13306:3306\n\n-e MYSQL_ROOT_PASSWORD=rootpwd\n\n-e MYSQL_USER=xx\n\n-e MYSQL_PASSWORD=testpwd\n\n-e MYSQL_ROOT_HOST=%\n\n-d mariadb\n\n3.以上步骤完成后mariadb 的 container mdb1 就直接运行了。\n\n在此踩了3个坑要注意：\n\n1.建立container是要注意SEliunx的限制，\n\n本地映射的文件夹 /home/xx/docker_mdb1_data必须关闭SELinux的保护：\n\nchcon -Rt svirt_sandbox_file_t /home/xx/docker_mdb1_data\n\n2.使用mysql的root连接container时出现\n\nAccess denied for user 'root'@'localhost' (using password: NO)\n\n的错误，后续的坑也由此引发。在网上查找了一下可能有两个原因\n\n一,MYSQL_ROOT_PASSWORD和MYSQL_PASSWORD最好不要相同。\n\n二,要添加MYSQL_ROOT_HOST=%的环境变量\n\n3.建立container后出现mysql相关系统错误时，比如Access denied for user 'root'@'localhost' (using password: NO)\n\n重新建container的时候必须连外部映射的存储/home/xx/docker_mdb1_data全部删除干净。\n\nsudo rm -rf /home/xx/docker_mdb1_data\n\n```",[[1532327081635,["lixq@lixq-PC",[[1,0,"\n"]],[0,0],[1,1]]],[1532327082271,["lixq@lixq-PC",[[1,0,"---\ntitle:\ncategories:\ntags:\n---"]],[0,0],[32,32]]],[1532327096810,["lixq@lixq-PC",[[-1,221,"qianqiannihao"]],[221,234],[221,221]]],[1532327105455,["lixq@lixq-PC",[[-1,507,"testpwd"]],[507,514],[507,507]]],[1532327107768,["lixq@lixq-PC",[[-1,462,"rootpwd"]],[462,469],[462,462]]]],null,"lixq@lixq-PC"],["275cf155-343e-4c26-9afa-41281ca0730c",1532327619513,"---\ntitle:\ncategories:\ntags:\n---\n# MySQL\n\n\n## 显示所有的数据库\n\n\n\n```\n\nshow databases;\n\n\n```\n\n1251错误\n\n我的是8.0的版本，因为比较新的mysql采用新的保密方式所以旧的似乎不能用，改密码方式：\n\n```\n\nuse mysql；\nALTER USER 'root'@'%' IDENTIFIED WITH mysql_native_password BY '';\n\nFLUSH PRIVILEGES; \n```\n\n\n\n\n这两天用docker搭了个mariadb碰到一些问题在此记录一下。\n\n搭建步骤\n```\n\n1 docker pull 最新的 mariadb镜像\n\n2. 用镜像建立mariadb的 container\n\ndocker run --name mdb1 -v /home/xx/docker_mdb1_data:/var/lib/mysql \\\n\n-p 13306:3306\n\n-e MYSQL_ROOT_PASSWORD=\n\n-e MYSQL_USER=xx\n\n-e MYSQL_PASSWORD=\n\n-e MYSQL_ROOT_HOST=%\n\n-d mariadb\n\n3.以上步骤完成后mariadb 的 container mdb1 就直接运行了。\n\n在此踩了3个坑要注意：\n\n1.建立container是要注意SEliunx的限制，\n\n本地映射的文件夹 /home/xx/docker_mdb1_data必须关闭SELinux的保护：\n\nchcon -Rt svirt_sandbox_file_t /home/xx/docker_mdb1_data\n\n2.使用mysql的root连接container时出现\n\nAccess denied for user 'root'@'localhost' (using password: NO)\n\n的错误，后续的坑也由此引发。在网上查找了一下可能有两个原因\n\n一,MYSQL_ROOT_PASSWORD和MYSQL_PASSWORD最好不要相同。\n\n二,要添加MYSQL_ROOT_HOST=%的环境变量\n\n3.建立container后出现mysql相关系统错误时，比如Access denied for user 'root'@'localhost' (using password: NO)\n\n重新建container的时候必须连外部映射的存储/home/xx/docker_mdb1_data全部删除干净。\n\nsudo rm -rf /home/xx/docker_mdb1_data\n\n```",[[1532327565075,["lixq@lixq-PC",[[1,29,"\n"]],[28,28],[29,29]]],[1532327566938,["lixq@lixq-PC",[[1,29,"- mysql"]],[29,29],[36,36]]],[1532327570667,["lixq@lixq-PC",[[-1,41,"# MySQL"]],[41,48],[41,41]]],[1532327577202,["lixq@lixq-PC",[[1,10," mysql "]],[10,10],[17,17]]],[1532327580562,["lixq@lixq-PC",[[-1,16," "]],[17,17],[16,16]]],[1532327587871,["lixq@lixq-PC",[[1,16,"学习进度1"]],[16,16],[21,21]]],[1532327608504,["lixq@lixq-PC",[[1,33," 学习"]],[33,33],[36,36]]]],null,"lixq@lixq-PC"]]}